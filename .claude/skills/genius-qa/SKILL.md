---
name: genius-qa
description: Comprehensive QA skill with dual testing strategy using Playwright for automated tests and visual testing. Runs full audits before deployment. Use for "run tests", "test this", "quality check", "QA audit".
---

## ‚ö†Ô∏è MANDATORY ARTIFACT

**This skill MUST generate:**
- Report: `QA-REPORT.md`
- HTML Playground: `.genius/outputs/QA-REPORT.html`

**Before transitioning to next skill:**
1. Verify QA-REPORT.md exists
2. Verify HTML playground exists
3. Update state.json checkpoint
4. Announce transition

**If artifacts missing:** DO NOT proceed. Generate them first.

---

# Genius QA v9.0 ‚Äî The Quality Guardian

**Quality is not an act, it is a habit.**

## Memory Integration

### On Audit Start
Read `@.genius/memory/BRIEFING.md` for project context and known issues.
Check errors.json for previously found bugs.

### On Issue Found
Append to `.genius/memory/errors.json`:
```json
{"id": "e-XXX", "error": "QA: [type] [severity] in [path]", "solution": "see CORRECTIONS.xml", "timestamp": "ISO-date", "tags": ["qa", "issue"]}
```

### On Audit Complete
Append to `.genius/memory/decisions.json`:
```json
{"id": "d-XXX", "decision": "QA AUDIT: [domain] SCORE: [score]/100 | ISSUES: [count]", "reason": "audit complete", "timestamp": "ISO-date", "tags": ["qa", "audit", "complete"]}
```

---

## The Five Audit Domains

| Domain | Weight | What to Check |
|--------|--------|---------------|
| Functional | 25% | Features work, user flows, edge cases, error states |
| Technical | 25% | TypeScript strict, no errors, proper handling, bundle size |
| Security | 20% | No secrets, no injection, auth/authz, input validation |
| Architecture | 15% | Folder structure, separation of concerns, no circular deps |
| UI/UX | 15% | Responsive, accessible (WCAG AA), consistent |

---

## Testing Strategy

- **Unit Tests**: `npm run test:unit -- --coverage`
- **Integration Tests**: `npm run test:integration`
- **E2E Tests**: `npx playwright test`
- **Security Tests**: `npm audit`
- **Performance Tests**: Lighthouse

---

## Output

- `AUDIT-REPORT.md` ‚Äî Scores per domain, findings, recommendations
- `CORRECTIONS.xml` ‚Äî Prioritized fix list with AI fix prompts

---

## Quality Gates

1. **Development Complete**: Unit tests pass, coverage > 80%
2. **Integration Ready**: API contracts verified
3. **Release Candidate**: All E2E pass, security clean, accessibility passed
4. **Production Ready**: All corrections applied, documentation complete

---

## Handoffs

### From genius-orchestrator
Receives: PROGRESS.md, all implemented files

### To genius-dev
Provides: CORRECTIONS.xml with prioritized fix prompts

### To genius-security
Provides: Security-related findings

### To genius-deployer
Provides: QA approval status, test results summary

---

## Playground Integration

### Visual Dashboard: Test Coverage Map

After running tests, generate a visual QA report using the Test Coverage Map playground.

### Flow

1. **Collect Metrics** ‚Äî After test execution, gather coverage data from all modules
2. **Generate Report** ‚Äî Create `.genius/outputs/QA-REPORT.html` with embedded data
3. **User Visualizes:**
   - üìç **Heatmap** ‚Äî Modules colored by coverage (green ‚â•80%, yellow 50-79%, red <50%)
   - üêõ **Bug Tracker** ‚Äî Issues sorted by severity (critical/high/medium/low)
   - üìä **Global Stats** ‚Äî Coverage %, tests passed/failed, open bugs count
   - üìÖ **Timeline** ‚Äî Recent test run history with trends

### Data Format

Inject this data structure into the playground template:

```javascript
const state = {
    modules: [
        {
            id: "module-id",           // unique identifier
            name: "Module Name",       // display name
            icon: "üì¶",                // emoji icon
            coverage: 85,              // percentage (0-100)
            tests: [
                { name: "Test name", type: "unit|integration|e2e", status: "passed|failed|skipped" }
            ],
            bugs: [
                { id: "BUG-001", title: "Bug description", severity: "critical|high|medium|low", module: "module-id", assignee: "Name" }
            ]
        }
    ],
    testRuns: [
        { date: "Feb 15", passed: 38, failed: 4, coverage: 72, status: "success|warning|danger" }
    ]
};
```

### Generation Steps

1. Copy template from `playgrounds/templates/test-coverage-map.html`
2. Replace the default `state` object with actual test data
3. Save to `.genius/outputs/QA-REPORT.html`
4. Include summary in `AUDIT-REPORT.md` with link to visual dashboard

### Prompt Output

The QA report includes:
- Overall statistics (coverage %, pass rate, bug count)
- Critical issues (low coverage modules, failed tests, high-priority bugs)
- Latest test run summary
- Prioritized recommendations
- Module-by-module breakdown

This report is auto-generated by the playground and can be copied for handoffs.
