<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Deploy Checklist - Genius Playground</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, sans-serif;
            background: linear-gradient(135deg, #0f0f1a 0%, #1a1a2e 50%, #16213e 100%);
            min-height: 100vh;
            color: #e0e0e0;
            padding: 20px;
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
        }
        
        header {
            text-align: center;
            margin-bottom: 30px;
        }
        
        h1 {
            font-size: 2.5rem;
            background: linear-gradient(135deg, #00d4ff, #7c3aed);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 10px;
        }
        
        .subtitle {
            color: #888;
            font-size: 1.1rem;
        }
        
        /* Go/No-Go Indicator */
        .go-nogo-indicator {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 20px;
            margin: 20px 0;
            padding: 20px;
            background: rgba(0,0,0,0.3);
            border-radius: 16px;
            border: 2px solid #333;
        }
        
        .go-nogo-status {
            font-size: 3rem;
            font-weight: bold;
            text-transform: uppercase;
            letter-spacing: 4px;
            padding: 15px 40px;
            border-radius: 12px;
            transition: all 0.3s ease;
        }
        
        .go-nogo-status.go {
            background: linear-gradient(135deg, #10b981, #059669);
            color: white;
            box-shadow: 0 0 30px rgba(16, 185, 129, 0.5);
            animation: pulse-go 2s infinite;
        }
        
        .go-nogo-status.nogo {
            background: linear-gradient(135deg, #ef4444, #dc2626);
            color: white;
            box-shadow: 0 0 30px rgba(239, 68, 68, 0.5);
        }
        
        .go-nogo-status.caution {
            background: linear-gradient(135deg, #f59e0b, #d97706);
            color: white;
            box-shadow: 0 0 30px rgba(245, 158, 11, 0.5);
            animation: pulse-caution 1.5s infinite;
        }
        
        @keyframes pulse-go {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.02); }
        }
        
        @keyframes pulse-caution {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.8; }
        }
        
        /* Progress Bar */
        .progress-section {
            margin: 20px 0;
        }
        
        .progress-bar-container {
            background: rgba(0,0,0,0.4);
            border-radius: 20px;
            padding: 5px;
            border: 1px solid #333;
        }
        
        .progress-bar {
            height: 30px;
            border-radius: 15px;
            background: linear-gradient(90deg, #ef4444 0%, #f59e0b 50%, #10b981 100%);
            transition: width 0.5s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            color: white;
            text-shadow: 0 1px 2px rgba(0,0,0,0.5);
            min-width: 60px;
        }
        
        .progress-stats {
            display: flex;
            justify-content: space-between;
            margin-top: 10px;
            font-size: 0.9rem;
            color: #888;
        }
        
        /* Presets */
        .presets-section {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            margin-bottom: 20px;
        }
        
        .preset-btn {
            padding: 10px 20px;
            border: 2px solid #444;
            background: rgba(0,0,0,0.3);
            color: #e0e0e0;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.2s ease;
            font-size: 0.95rem;
        }
        
        .preset-btn:hover {
            border-color: #7c3aed;
            background: rgba(124, 58, 237, 0.2);
        }
        
        .preset-btn.active {
            border-color: #7c3aed;
            background: rgba(124, 58, 237, 0.3);
            color: white;
        }
        
        /* Main Layout */
        .main-layout {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
        }
        
        @media (max-width: 1200px) {
            .main-layout {
                grid-template-columns: 1fr;
            }
        }
        
        /* Phases */
        .phases-section {
            display: flex;
            flex-direction: column;
            gap: 20px;
        }
        
        .phase {
            background: rgba(0,0,0,0.3);
            border-radius: 16px;
            border: 1px solid #333;
            overflow: hidden;
        }
        
        .phase-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px 20px;
            background: rgba(0,0,0,0.3);
            cursor: pointer;
            transition: background 0.2s ease;
        }
        
        .phase-header:hover {
            background: rgba(0,0,0,0.4);
        }
        
        .phase-title {
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 1.2rem;
            font-weight: 600;
        }
        
        .phase-icon {
            font-size: 1.5rem;
        }
        
        .phase-progress {
            font-size: 0.9rem;
            color: #888;
        }
        
        .phase-content {
            padding: 15px;
        }
        
        .phase.collapsed .phase-content {
            display: none;
        }
        
        /* Categories */
        .category {
            margin-bottom: 15px;
        }
        
        .category-title {
            font-size: 0.85rem;
            text-transform: uppercase;
            letter-spacing: 1px;
            color: #888;
            margin-bottom: 8px;
            padding-left: 10px;
            border-left: 3px solid #7c3aed;
        }
        
        /* Checklist Items */
        .checklist-item {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 12px 15px;
            background: rgba(255,255,255,0.03);
            border-radius: 10px;
            margin-bottom: 8px;
            transition: all 0.2s ease;
            border: 1px solid transparent;
        }
        
        .checklist-item:hover {
            background: rgba(255,255,255,0.06);
            border-color: #444;
        }
        
        .checklist-item.critical {
            border-left: 3px solid #ef4444;
        }
        
        .checklist-item.critical.not-done {
            background: rgba(239, 68, 68, 0.1);
            border-color: rgba(239, 68, 68, 0.3);
        }
        
        .status-toggle {
            width: 36px;
            height: 36px;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            font-size: 1.2rem;
            transition: all 0.2s ease;
            flex-shrink: 0;
        }
        
        .status-toggle.not-done {
            background: rgba(239, 68, 68, 0.2);
            border: 2px solid #ef4444;
            color: #ef4444;
        }
        
        .status-toggle.in-progress {
            background: rgba(245, 158, 11, 0.2);
            border: 2px solid #f59e0b;
            color: #f59e0b;
            animation: spin-slow 3s linear infinite;
        }
        
        .status-toggle.done {
            background: rgba(16, 185, 129, 0.2);
            border: 2px solid #10b981;
            color: #10b981;
        }
        
        @keyframes spin-slow {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }
        
        .item-content {
            flex: 1;
        }
        
        .item-name {
            font-weight: 500;
            margin-bottom: 2px;
        }
        
        .item-desc {
            font-size: 0.85rem;
            color: #888;
        }
        
        .item-timer {
            font-size: 0.8rem;
            color: #7c3aed;
            font-family: 'Monaco', 'Consolas', monospace;
            min-width: 60px;
            text-align: right;
        }
        
        .critical-badge {
            background: rgba(239, 68, 68, 0.2);
            color: #ef4444;
            padding: 2px 8px;
            border-radius: 4px;
            font-size: 0.7rem;
            text-transform: uppercase;
            font-weight: 600;
        }
        
        /* Blocker Warning */
        .blocker-warning {
            background: linear-gradient(135deg, rgba(239, 68, 68, 0.2), rgba(239, 68, 68, 0.1));
            border: 2px solid #ef4444;
            border-radius: 12px;
            padding: 20px;
            margin: 20px 0;
            animation: shake 0.5s ease-in-out;
        }
        
        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-5px); }
            75% { transform: translateX(5px); }
        }
        
        .blocker-warning h3 {
            color: #ef4444;
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 10px;
        }
        
        .blocker-list {
            list-style: none;
            padding-left: 30px;
        }
        
        .blocker-list li {
            padding: 5px 0;
            color: #f87171;
        }
        
        .blocker-list li::before {
            content: "‚õî ";
        }
        
        /* Rollback Section */
        .rollback-section {
            background: rgba(124, 58, 237, 0.1);
            border: 1px solid rgba(124, 58, 237, 0.3);
            border-radius: 12px;
            padding: 20px;
            margin-top: 20px;
        }
        
        .rollback-section h3 {
            color: #a78bfa;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .rollback-textarea {
            width: 100%;
            min-height: 120px;
            background: rgba(0,0,0,0.3);
            border: 1px solid #444;
            border-radius: 8px;
            padding: 15px;
            color: #e0e0e0;
            font-family: 'Monaco', 'Consolas', monospace;
            font-size: 0.9rem;
            resize: vertical;
        }
        
        .rollback-textarea:focus {
            outline: none;
            border-color: #7c3aed;
        }
        
        /* Output Section */
        .output-section {
            background: rgba(0,0,0,0.3);
            border-radius: 16px;
            border: 1px solid #333;
            padding: 20px;
            display: flex;
            flex-direction: column;
            height: fit-content;
            position: sticky;
            top: 20px;
        }
        
        .output-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }
        
        .output-title {
            font-size: 1.2rem;
            font-weight: 600;
            color: #00d4ff;
        }
        
        .copy-btn {
            padding: 10px 20px;
            background: linear-gradient(135deg, #7c3aed, #a855f7);
            border: none;
            border-radius: 8px;
            color: white;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s ease;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .copy-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 20px rgba(124, 58, 237, 0.4);
        }
        
        .copy-btn.copied {
            background: linear-gradient(135deg, #10b981, #059669);
        }
        
        .prompt-output {
            background: rgba(0,0,0,0.4);
            border: 1px solid #444;
            border-radius: 8px;
            padding: 15px;
            font-family: 'Monaco', 'Consolas', monospace;
            font-size: 0.85rem;
            line-height: 1.6;
            white-space: pre-wrap;
            max-height: 600px;
            overflow-y: auto;
            color: #a0a0a0;
        }
        
        .prompt-output::-webkit-scrollbar {
            width: 8px;
        }
        
        .prompt-output::-webkit-scrollbar-track {
            background: rgba(0,0,0,0.2);
            border-radius: 4px;
        }
        
        .prompt-output::-webkit-scrollbar-thumb {
            background: #444;
            border-radius: 4px;
        }
        
        /* Total Time */
        .total-time {
            text-align: center;
            margin-top: 15px;
            padding-top: 15px;
            border-top: 1px solid #333;
        }
        
        .total-time-label {
            font-size: 0.9rem;
            color: #888;
        }
        
        .total-time-value {
            font-size: 1.5rem;
            font-weight: bold;
            color: #00d4ff;
            font-family: 'Monaco', 'Consolas', monospace;
        }
        
        /* Project Info */
        .project-info {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin-bottom: 20px;
        }
        
        .info-field {
            display: flex;
            flex-direction: column;
            gap: 5px;
        }
        
        .info-field label {
            font-size: 0.85rem;
            color: #888;
        }
        
        .info-field input {
            background: rgba(0,0,0,0.3);
            border: 1px solid #444;
            border-radius: 8px;
            padding: 10px 15px;
            color: #e0e0e0;
            font-size: 1rem;
        }
        
        .info-field input:focus {
            outline: none;
            border-color: #7c3aed;
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>üöÄ Deploy Checklist</h1>
            <p class="subtitle">Interactive deployment validation with live status tracking</p>
        </header>
        
        <!-- Go/No-Go Indicator -->
        <div class="go-nogo-indicator">
            <div id="goNoGoStatus" class="go-nogo-status nogo">NO-GO</div>
        </div>
        
        <!-- Progress Bar -->
        <div class="progress-section">
            <div class="progress-bar-container">
                <div id="progressBar" class="progress-bar" style="width: 0%">0%</div>
            </div>
            <div class="progress-stats">
                <span id="doneCount">0 done</span>
                <span id="inProgressCount">0 in progress</span>
                <span id="notDoneCount">0 remaining</span>
            </div>
        </div>
        
        <!-- Presets -->
        <div class="presets-section">
            <button class="preset-btn" onclick="loadPreset('first-deploy')">üÜï First Deploy</button>
            <button class="preset-btn" onclick="loadPreset('hotfix')">üî• Hotfix</button>
            <button class="preset-btn" onclick="loadPreset('major-release')">üì¶ Major Release</button>
            <button class="preset-btn" onclick="loadPreset('database-migration')">üóÉÔ∏è Database Migration</button>
            <button class="preset-btn" onclick="resetAll()">üîÑ Reset All</button>
        </div>
        
        <!-- Project Info -->
        <div class="project-info">
            <div class="info-field">
                <label>Project Name</label>
                <input type="text" id="projectName" placeholder="my-awesome-project" oninput="updateAll()">
            </div>
            <div class="info-field">
                <label>Version / Tag</label>
                <input type="text" id="versionTag" placeholder="v1.2.3" oninput="updateAll()">
            </div>
            <div class="info-field">
                <label>Environment</label>
                <input type="text" id="targetEnv" placeholder="production" oninput="updateAll()">
            </div>
            <div class="info-field">
                <label>Deploy Date</label>
                <input type="text" id="deployDate" placeholder="2024-01-15 14:00 UTC" oninput="updateAll()">
            </div>
        </div>
        
        <!-- Blocker Warning (hidden by default) -->
        <div id="blockerWarning" class="blocker-warning" style="display: none;">
            <h3>üö® BLOCKERS DETECTED</h3>
            <p>Critical items must be completed before deployment:</p>
            <ul id="blockerList" class="blocker-list"></ul>
        </div>
        
        <div class="main-layout">
            <!-- Phases Section -->
            <div class="phases-section">
                <div id="phasesContainer"></div>
                
                <!-- Rollback Section -->
                <div class="rollback-section">
                    <h3>üîô Rollback Plan</h3>
                    <textarea id="rollbackPlan" class="rollback-textarea" placeholder="Document your rollback strategy here...

Example:
1. Revert to previous Docker image: docker pull myapp:v1.2.2
2. Restore database backup: pg_restore -d mydb backup_20240115.sql
3. Clear CDN cache: cf cache purge --zone myzone
4. Notify team: #deployments channel" oninput="updateAll()"></textarea>
                </div>
            </div>
            
            <!-- Output Section -->
            <div class="output-section">
                <div class="output-header">
                    <span class="output-title">üìã Deployment Status</span>
                    <button id="copyBtn" class="copy-btn" onclick="copyPrompt()">
                        <span>üìã</span> Copy
                    </button>
                </div>
                <pre id="promptOutput" class="prompt-output"></pre>
                <div class="total-time">
                    <div class="total-time-label">Total Time Spent</div>
                    <div id="totalTime" class="total-time-value">00:00:00</div>
                </div>
            </div>
        </div>
    </div>
    
    <script>
        // ========== STATE ==========
        const state = {
            projectName: '',
            versionTag: '',
            targetEnv: '',
            deployDate: '',
            rollbackPlan: '',
            activePreset: null,
            startTime: Date.now(),
            items: {},
            timers: {}
        };
        
        // ========== CHECKLIST DEFINITION ==========
        const phases = [
            {
                id: 'pre-deploy',
                name: 'Pre-Deploy',
                icon: 'üìã',
                categories: {
                    'Environment': [
                        { id: 'env-vars', name: 'Environment variables configured', desc: 'All secrets and configs set', critical: true },
                        { id: 'env-backup', name: 'Current env backup taken', desc: 'Snapshot of current state' },
                        { id: 'env-permissions', name: 'Access permissions verified', desc: 'SSH keys, API tokens valid' }
                    ],
                    'Database': [
                        { id: 'db-backup', name: 'Database backup completed', desc: 'Full backup with verification', critical: true },
                        { id: 'db-migrations', name: 'Migrations tested locally', desc: 'Run against clone of prod' },
                        { id: 'db-rollback', name: 'Rollback script ready', desc: 'Can revert schema changes' }
                    ],
                    'Code': [
                        { id: 'code-review', name: 'Code review approved', desc: 'All PRs merged and approved', critical: true },
                        { id: 'code-conflicts', name: 'No merge conflicts', desc: 'Clean merge to main/master' },
                        { id: 'code-changelog', name: 'Changelog updated', desc: 'Version notes documented' }
                    ],
                    'Tests': [
                        { id: 'tests-unit', name: 'Unit tests passing', desc: 'All unit tests green', critical: true },
                        { id: 'tests-integration', name: 'Integration tests passing', desc: 'API and service tests' },
                        { id: 'tests-e2e', name: 'E2E tests passing', desc: 'End-to-end user flows' }
                    ]
                }
            },
            {
                id: 'deploy',
                name: 'Deploy',
                icon: 'üöÄ',
                categories: {
                    'Deployment': [
                        { id: 'deploy-notify', name: 'Team notified', desc: 'Posted in #deployments' },
                        { id: 'deploy-maintenance', name: 'Maintenance mode enabled', desc: 'If required for this deploy' },
                        { id: 'deploy-execute', name: 'Deployment executed', desc: 'Code pushed to production', critical: true },
                        { id: 'deploy-verify', name: 'Deployment verified', desc: 'New version is live' }
                    ],
                    'Database': [
                        { id: 'deploy-migrations', name: 'Migrations applied', desc: 'Schema changes executed' },
                        { id: 'deploy-seeds', name: 'Seeds/fixtures run', desc: 'If new data required' }
                    ]
                }
            },
            {
                id: 'post-deploy',
                name: 'Post-Deploy',
                icon: '‚úÖ',
                categories: {
                    'Monitoring': [
                        { id: 'monitor-errors', name: 'Error rates checked', desc: 'Sentry/logging clean', critical: true },
                        { id: 'monitor-perf', name: 'Performance baseline', desc: 'Response times normal' },
                        { id: 'monitor-alerts', name: 'Alerts configured', desc: 'New features monitored' }
                    ],
                    'DNS': [
                        { id: 'dns-propagation', name: 'DNS propagation verified', desc: 'If DNS changes made' },
                        { id: 'dns-cdn', name: 'CDN cache cleared', desc: 'Cloudflare/Fastly purged' }
                    ],
                    'SSL': [
                        { id: 'ssl-valid', name: 'SSL certificate valid', desc: 'No expiry warnings' },
                        { id: 'ssl-redirect', name: 'HTTPS redirect working', desc: 'HTTP ‚Üí HTTPS active' }
                    ],
                    'Verification': [
                        { id: 'verify-smoke', name: 'Smoke tests passed', desc: 'Critical paths working', critical: true },
                        { id: 'verify-rollback', name: 'Rollback tested', desc: 'Can revert if needed' },
                        { id: 'verify-announce', name: 'Release announced', desc: 'Users/team informed' }
                    ]
                }
            },
            {
                id: 'rollback-plan',
                name: 'Rollback Plan',
                icon: 'üîô',
                categories: {
                    'Preparation': [
                        { id: 'rb-docker', name: 'Previous image tagged', desc: 'Can pull last working version' },
                        { id: 'rb-db-script', name: 'DB rollback script tested', desc: 'Schema can be reverted' },
                        { id: 'rb-config', name: 'Old config available', desc: 'Previous env vars saved' }
                    ],
                    'Communication': [
                        { id: 'rb-oncall', name: 'On-call team identified', desc: 'Who to contact if issues' },
                        { id: 'rb-timeline', name: 'Rollback timeline defined', desc: 'How long to wait before rollback' }
                    ]
                }
            }
        ];
        
        // ========== PRESETS ==========
        const presets = {
            'first-deploy': {
                name: 'First Deploy',
                required: ['env-vars', 'env-permissions', 'db-backup', 'code-review', 'tests-unit', 'deploy-execute', 'deploy-verify', 'ssl-valid', 'ssl-redirect', 'verify-smoke'],
                rollback: `First Deploy Rollback Plan:
1. If critical issues: Take down the service immediately
2. DNS: Point back to "Coming Soon" page
3. Database: Drop all tables (no previous data)
4. Document lessons learned for next deploy`
            },
            'hotfix': {
                name: 'Hotfix',
                required: ['code-review', 'tests-unit', 'deploy-execute', 'deploy-verify', 'monitor-errors', 'verify-smoke'],
                rollback: `Hotfix Rollback Plan:
1. Revert commit: git revert HEAD && git push
2. Redeploy previous version immediately
3. Notify team of rollback
4. Schedule proper fix for next sprint`
            },
            'major-release': {
                name: 'Major Release',
                required: ['env-vars', 'env-backup', 'db-backup', 'db-migrations', 'db-rollback', 'code-review', 'code-changelog', 'tests-unit', 'tests-integration', 'tests-e2e', 'deploy-notify', 'deploy-execute', 'deploy-verify', 'deploy-migrations', 'monitor-errors', 'monitor-perf', 'dns-cdn', 'verify-smoke', 'verify-announce', 'rb-docker', 'rb-db-script', 'rb-oncall'],
                rollback: `Major Release Rollback Plan:
1. STOP: Assess severity (P0/P1/P2)
2. If P0: Immediate rollback
   - docker pull myapp:previous-tag
   - kubectl rollout undo deployment/myapp
3. Database rollback:
   - Run: ./scripts/db-rollback.sh
4. Cache clear: Purge all CDN edges
5. Communicate: Post in #incidents
6. Post-mortem within 24h`
            },
            'database-migration': {
                name: 'Database Migration',
                required: ['db-backup', 'db-migrations', 'db-rollback', 'code-review', 'deploy-maintenance', 'deploy-execute', 'deploy-migrations', 'monitor-errors', 'rb-db-script'],
                rollback: `Database Migration Rollback Plan:
1. CRITICAL: Stop all writes immediately
2. Restore from backup:
   pg_restore -d mydb backup_TIMESTAMP.sql
3. Revert code that depends on new schema
4. Verify data integrity
5. Document which migrations to skip next time`
            }
        };
        
        // ========== INITIALIZATION ==========
        function init() {
            // Initialize all items to 'not-done' status
            phases.forEach(phase => {
                Object.values(phase.categories).flat().forEach(item => {
                    state.items[item.id] = 'not-done';
                    state.timers[item.id] = 0;
                });
            });
            
            renderPhases();
            updateAll();
            
            // Update timers every second
            setInterval(updateTimers, 1000);
        }
        
        // ========== RENDERING ==========
        function renderPhases() {
            const container = document.getElementById('phasesContainer');
            container.innerHTML = phases.map(phase => `
                <div class="phase" id="phase-${phase.id}">
                    <div class="phase-header" onclick="togglePhase('${phase.id}')">
                        <div class="phase-title">
                            <span class="phase-icon">${phase.icon}</span>
                            <span>${phase.name}</span>
                        </div>
                        <span class="phase-progress" id="progress-${phase.id}">0/0</span>
                    </div>
                    <div class="phase-content">
                        ${Object.entries(phase.categories).map(([catName, items]) => `
                            <div class="category">
                                <div class="category-title">${catName}</div>
                                ${items.map(item => renderItem(item)).join('')}
                            </div>
                        `).join('')}
                    </div>
                </div>
            `).join('');
        }
        
        function renderItem(item) {
            const status = state.items[item.id] || 'not-done';
            const timer = state.timers[item.id] || 0;
            const statusIcons = {
                'not-done': '‚úó',
                'in-progress': '‚è≥',
                'done': '‚úì'
            };
            
            return `
                <div class="checklist-item ${item.critical ? 'critical' : ''} ${item.critical && status === 'not-done' ? 'not-done' : ''}" id="item-${item.id}">
                    <div class="status-toggle ${status}" onclick="toggleStatus('${item.id}')" title="Click to change status">
                        ${statusIcons[status]}
                    </div>
                    <div class="item-content">
                        <div class="item-name">
                            ${item.name}
                            ${item.critical ? '<span class="critical-badge">Critical</span>' : ''}
                        </div>
                        <div class="item-desc">${item.desc}</div>
                    </div>
                    <div class="item-timer" id="timer-${item.id}">${formatTime(timer)}</div>
                </div>
            `;
        }
        
        // ========== ACTIONS ==========
        function toggleStatus(itemId) {
            const statusOrder = ['not-done', 'in-progress', 'done'];
            const currentIndex = statusOrder.indexOf(state.items[itemId]);
            const newStatus = statusOrder[(currentIndex + 1) % 3];
            
            state.items[itemId] = newStatus;
            
            // Reset timer when starting or when done
            if (newStatus === 'in-progress') {
                state.timers[itemId] = 0;
            }
            
            updateAll();
        }
        
        function togglePhase(phaseId) {
            const phase = document.getElementById(`phase-${phaseId}`);
            phase.classList.toggle('collapsed');
        }
        
        function loadPreset(presetId) {
            const preset = presets[presetId];
            if (!preset) return;
            
            state.activePreset = presetId;
            
            // Reset all items
            Object.keys(state.items).forEach(id => {
                state.items[id] = 'not-done';
                state.timers[id] = 0;
            });
            
            // Mark non-required items as done (skip them)
            phases.forEach(phase => {
                Object.values(phase.categories).flat().forEach(item => {
                    if (!preset.required.includes(item.id)) {
                        state.items[item.id] = 'done';
                    }
                });
            });
            
            // Set rollback plan
            document.getElementById('rollbackPlan').value = preset.rollback;
            state.rollbackPlan = preset.rollback;
            
            // Update preset buttons
            document.querySelectorAll('.preset-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            event.target.classList.add('active');
            
            renderPhases();
            updateAll();
        }
        
        function resetAll() {
            state.activePreset = null;
            state.startTime = Date.now();
            
            Object.keys(state.items).forEach(id => {
                state.items[id] = 'not-done';
                state.timers[id] = 0;
            });
            
            document.getElementById('rollbackPlan').value = '';
            state.rollbackPlan = '';
            
            document.querySelectorAll('.preset-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            
            renderPhases();
            updateAll();
        }
        
        // ========== UPDATE FUNCTIONS ==========
        function updateAll() {
            // Sync state from inputs
            state.projectName = document.getElementById('projectName').value;
            state.versionTag = document.getElementById('versionTag').value;
            state.targetEnv = document.getElementById('targetEnv').value;
            state.deployDate = document.getElementById('deployDate').value;
            state.rollbackPlan = document.getElementById('rollbackPlan').value;
            
            updateProgress();
            updateGoNoGo();
            updateBlockers();
            updatePhaseProgress();
            updateItemStyles();
            updatePrompt();
        }
        
        function updateProgress() {
            const items = Object.values(state.items);
            const done = items.filter(s => s === 'done').length;
            const inProgress = items.filter(s => s === 'in-progress').length;
            const notDone = items.filter(s => s === 'not-done').length;
            const total = items.length;
            const percent = Math.round((done / total) * 100);
            
            document.getElementById('progressBar').style.width = `${percent}%`;
            document.getElementById('progressBar').textContent = `${percent}%`;
            document.getElementById('doneCount').textContent = `${done} done`;
            document.getElementById('inProgressCount').textContent = `${inProgress} in progress`;
            document.getElementById('notDoneCount').textContent = `${notDone} remaining`;
        }
        
        function updateGoNoGo() {
            const indicator = document.getElementById('goNoGoStatus');
            const blockers = getBlockers();
            const inProgress = Object.values(state.items).filter(s => s === 'in-progress').length;
            
            if (blockers.length === 0 && inProgress === 0) {
                indicator.className = 'go-nogo-status go';
                indicator.textContent = '‚úì GO';
            } else if (blockers.length === 0 && inProgress > 0) {
                indicator.className = 'go-nogo-status caution';
                indicator.textContent = '‚è≥ WAIT';
            } else {
                indicator.className = 'go-nogo-status nogo';
                indicator.textContent = '‚úó NO-GO';
            }
        }
        
        function getBlockers() {
            const blockers = [];
            phases.forEach(phase => {
                Object.values(phase.categories).flat().forEach(item => {
                    if (item.critical && state.items[item.id] === 'not-done') {
                        blockers.push(item);
                    }
                });
            });
            return blockers;
        }
        
        function updateBlockers() {
            const blockers = getBlockers();
            const warning = document.getElementById('blockerWarning');
            const list = document.getElementById('blockerList');
            
            if (blockers.length > 0) {
                warning.style.display = 'block';
                list.innerHTML = blockers.map(b => `<li>${b.name}</li>`).join('');
            } else {
                warning.style.display = 'none';
            }
        }
        
        function updatePhaseProgress() {
            phases.forEach(phase => {
                const items = Object.values(phase.categories).flat();
                const done = items.filter(item => state.items[item.id] === 'done').length;
                document.getElementById(`progress-${phase.id}`).textContent = `${done}/${items.length}`;
            });
        }
        
        function updateItemStyles() {
            phases.forEach(phase => {
                Object.values(phase.categories).flat().forEach(item => {
                    const el = document.getElementById(`item-${item.id}`);
                    if (el) {
                        const status = state.items[item.id];
                        const toggle = el.querySelector('.status-toggle');
                        
                        toggle.className = `status-toggle ${status}`;
                        toggle.innerHTML = status === 'not-done' ? '‚úó' : status === 'in-progress' ? '‚è≥' : '‚úì';
                        
                        if (item.critical && status === 'not-done') {
                            el.classList.add('not-done');
                        } else {
                            el.classList.remove('not-done');
                        }
                    }
                });
            });
        }
        
        function updateTimers() {
            Object.keys(state.items).forEach(id => {
                if (state.items[id] === 'in-progress') {
                    state.timers[id]++;
                    const timerEl = document.getElementById(`timer-${id}`);
                    if (timerEl) {
                        timerEl.textContent = formatTime(state.timers[id]);
                    }
                }
            });
            
            // Update total time
            const totalSeconds = Math.floor((Date.now() - state.startTime) / 1000);
            document.getElementById('totalTime').textContent = formatTime(totalSeconds);
        }
        
        function formatTime(seconds) {
            const h = Math.floor(seconds / 3600);
            const m = Math.floor((seconds % 3600) / 60);
            const s = seconds % 60;
            return `${h.toString().padStart(2, '0')}:${m.toString().padStart(2, '0')}:${s.toString().padStart(2, '0')}`;
        }
        
        // ========== PROMPT OUTPUT ==========
        function updatePrompt() {
            const blockers = getBlockers();
            const items = Object.values(state.items);
            const done = items.filter(s => s === 'done').length;
            const inProgress = items.filter(s => s === 'in-progress').length;
            const notDone = items.filter(s => s === 'not-done').length;
            const total = items.length;
            const percent = Math.round((done / total) * 100);
            
            let status = 'üö´ NO-GO';
            if (blockers.length === 0 && inProgress === 0) {
                status = '‚úÖ GO - Ready to Deploy!';
            } else if (blockers.length === 0 && inProgress > 0) {
                status = '‚è≥ WAIT - Tasks in progress';
            }
            
            let output = `# DEPLOYMENT CHECKLIST STATUS
‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ

## üìä STATUS: ${status}

`;
            
            if (state.projectName || state.versionTag || state.targetEnv) {
                output += `## üìã Project Info
`;
                if (state.projectName) output += `- Project: ${state.projectName}\n`;
                if (state.versionTag) output += `- Version: ${state.versionTag}\n`;
                if (state.targetEnv) output += `- Environment: ${state.targetEnv}\n`;
                if (state.deployDate) output += `- Scheduled: ${state.deployDate}\n`;
                output += '\n';
            }
            
            output += `## üìà Progress: ${percent}%
- ‚úì Done: ${done}
- ‚è≥ In Progress: ${inProgress}
- ‚úó Not Done: ${notDone}

`;
            
            if (blockers.length > 0) {
                output += `## üö® BLOCKERS (${blockers.length})
`;
                blockers.forEach(b => {
                    output += `- ‚õî ${b.name}\n`;
                });
                output += '\n';
            }
            
            // Show in-progress items
            const inProgressItems = [];
            phases.forEach(phase => {
                Object.values(phase.categories).flat().forEach(item => {
                    if (state.items[item.id] === 'in-progress') {
                        inProgressItems.push({ ...item, time: state.timers[item.id] });
                    }
                });
            });
            
            if (inProgressItems.length > 0) {
                output += `## ‚è≥ In Progress
`;
                inProgressItems.forEach(item => {
                    output += `- ${item.name} (${formatTime(item.time)})\n`;
                });
                output += '\n';
            }
            
            // Show remaining non-critical items
            const remainingItems = [];
            phases.forEach(phase => {
                Object.values(phase.categories).flat().forEach(item => {
                    if (state.items[item.id] === 'not-done' && !item.critical) {
                        remainingItems.push(item);
                    }
                });
            });
            
            if (remainingItems.length > 0) {
                output += `## üìù Remaining Items (${remainingItems.length})
`;
                remainingItems.forEach(item => {
                    output += `- ${item.name}\n`;
                });
                output += '\n';
            }
            
            // Phase summary
            output += `## üìä Phase Summary
`;
            phases.forEach(phase => {
                const phaseItems = Object.values(phase.categories).flat();
                const phaseDone = phaseItems.filter(item => state.items[item.id] === 'done').length;
                const phasePercent = Math.round((phaseDone / phaseItems.length) * 100);
                const bar = '‚ñà'.repeat(Math.floor(phasePercent / 10)) + '‚ñë'.repeat(10 - Math.floor(phasePercent / 10));
                output += `${phase.icon} ${phase.name}: [${bar}] ${phasePercent}%\n`;
            });
            output += '\n';
            
            if (state.rollbackPlan) {
                output += `## üîô Rollback Plan
${state.rollbackPlan}
`;
            }
            
            const totalSeconds = Math.floor((Date.now() - state.startTime) / 1000);
            output += `
‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ
Generated: ${new Date().toISOString()}
Session Duration: ${formatTime(totalSeconds)}`;
            
            document.getElementById('promptOutput').textContent = output;
        }
        
        // ========== COPY ==========
        function copyPrompt() {
            const text = document.getElementById('promptOutput').textContent;
            navigator.clipboard.writeText(text).then(() => {
                const btn = document.getElementById('copyBtn');
                btn.innerHTML = '<span>‚úì</span> Copied!';
                btn.classList.add('copied');
                setTimeout(() => {
                    btn.innerHTML = '<span>üìã</span> Copy';
                    btn.classList.remove('copied');
                }, 2000);
            });
        }
        
        // ========== INIT ==========
        init();
    </script>
</body>
</html>
